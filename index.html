<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Separation and typing of flood events and typewise staistical return periods (TMPS) • FloodR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Separation and typing of flood events and typewise staistical return periods (TMPS)">
<meta property="og:description" content="Flood event separation on the basis of daily and hourly mean discharges using a variance based threshold. The monthly maximum discharges are used as peak values. To define the event separation, first an interpolation algorithm based on Thiessen polygons is used to transform station precipitation into areal precipitation. With the areal precipitation, the event precipitation for each event can be defined using a change-point based approach applied to slope of the cummulative sums of the precipitation.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">FloodR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/flood_division.html">flood events division</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## ℹ Loading FloodR</span></span></code></pre></div>
<!-- README.md is generated from README.Rmd. Please edit that file --><div class="section level1">
<div class="page-header"><h1 id="floodr">FloodR<a class="anchor" aria-label="anchor" href="#floodr"></a>
</h1></div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>This package provides tools for:</p>
<ul>
<li>Separation of flood events from discharge timeseries</li>
<li>Spatial interpolation of precipitation</li>
<li>Separation of storm events from precipitation timeseries</li>
<li>Flood event typology<ul>
<li>Typing of rain events by TQ-Value</li>
<li>Typing of snow events by clustering</li>
</ul>
</li>
<li>TMPS: Floodtype-based Mixture Model of Partial Duration Series<ul>
<li>typewise statistical estimate of return periods</li>
<li>typewise statistical estimate of quantiles</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation-and-usage">Installation and usage<a class="anchor" aria-label="anchor" href="#installation-and-usage"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"PhilippBuehler/FloodR"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"FloodR"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="separation-of-flood-events">Separation of flood events<a class="anchor" aria-label="anchor" href="#separation-of-flood-events"></a>
</h3>
<p>For the separation of flood events from a discharge timeseries, we need the daily discharge.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a data.frame with continuous daily discharge</span></span>
<span><span class="va">dailyMQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01.01.2000"</span>, format<span class="op">=</span><span class="st">"%d.%m.%Y"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01.01.2004"</span>, format<span class="op">=</span><span class="st">"%d.%m.%Y"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"days"</span><span class="op">)</span>,</span>
<span>  discharge<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1462</span>,<span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run the separation</span></span>
<span><span class="va">Flood_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/eventsep.html">eventsep</a></span><span class="op">(</span><span class="va">dailyMQ</span><span class="op">)</span></span>
<span><span class="co"># The Separation might still contain overlaid flood events which need to be corrected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Flood_events</span><span class="op">)</span></span>
<span><span class="co">#        Begin        End  Peak_date  DailyMQ      Volume dir_Volume</span></span>
<span><span class="co"># 1 2000-01-16 2000-01-19 2000-01-18 15.35592    3.021114   2.174865</span></span>
<span><span class="co"># 2 2000-02-13 2003-12-29 2001-09-28 44.27642 1075.325974 534.077564</span></span>
<span><span class="co"># 3 2000-05-23 2000-06-02 2000-05-31 15.73240    4.941116   4.224436</span></span>
<span><span class="co"># 4 2000-06-06 2000-06-10 2000-06-08 15.48383    2.875110   1.896021</span></span>
<span><span class="co"># 5 2000-06-19 2000-08-02 2000-07-26 25.61361   38.245501  32.558629</span></span>
<span><span class="co"># 6 2001-04-18 2001-05-14 2001-05-03 20.11446   17.395686  12.098132</span></span>
<span><span class="co">#   baseflow_peak baseflow_begin baseflow_end No_Peaks HQ HQ_dir Comments</span></span>
<span><span class="co"># 1     3.5861595      2.3009200     4.228779        1 NA     NA         </span></span>
<span><span class="co"># 2     4.3944127      4.2247479     4.629597       73 NA     NA         </span></span>
<span><span class="co"># 3     0.9831886      0.5733279     1.085654        1 NA     NA overlaid</span></span>
<span><span class="co"># 4     2.8330141      1.5119888     4.154039        1 NA     NA overlaid</span></span>
<span><span class="co"># 5     2.1499803      0.5366202     2.455211        4 NA     NA overlaid</span></span>
<span><span class="co"># 6     2.6180248      0.6696508     4.046832        1 NA     NA overlaid</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="correction-of-flood-events">Correction of flood events<a class="anchor" aria-label="anchor" href="#correction-of-flood-events"></a>
</h3>
<p>Run the Web separation on the dummy Catchment As input to the function a minimum of discharge data is used. The Flood event tables can be opened from within the User-Interface</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/Run_WebFlood.html">Run_WebFlood</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="separation-of-precipitation">Separation of precipitation<a class="anchor" aria-label="anchor" href="#separation-of-precipitation"></a>
</h3>
<p>After the flood events are corrected (if needed), the precipitation belonging to flood event need to be estimated For the both functions, a daily precipitation timeseries is needed, as well as the parameter indT, which has the position indices of begin, end and peak of the FLOOD event as vector.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a sample dataset</span></span>
<span><span class="va">dailyprec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01.01.2000"</span>, format<span class="op">=</span><span class="st">"%d.%m.%Y"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"30.04.2000"</span>, format<span class="op">=</span><span class="st">"%d.%m.%Y"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"days"</span><span class="op">)</span>,</span>
<span>  discharge<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">121</span>,<span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create indices of beginning, end and peak of the flood event</span></span>
<span><span class="va">indT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">14</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">dailyprec</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">30</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Run the separation for both methods</span></span>
<span><span class="va">Date1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/PreconeCP.html">PreconeCP</a></span><span class="op">(</span><span class="va">dailyprec</span>, indT <span class="op">=</span> <span class="va">indT</span><span class="op">)</span></span>
<span><span class="va">Date2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/PrectwoCP.html">PrectwoCP</a></span><span class="op">(</span><span class="va">dailyprec</span>, indT <span class="op">=</span> <span class="va">indT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Method1"</span> <span class="op">=</span> <span class="va">Date1</span>, <span class="st">"Method2"</span> <span class="op">=</span> <span class="va">Date2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#      Method1      Method2 </span></span>
<span><span class="co"># "2000-01-08" "2000-01-08"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="typing-of-flood-events">Typing of flood events<a class="anchor" aria-label="anchor" href="#typing-of-flood-events"></a>
</h3>
<p>For the typing of the flood event, multiple characteristics for each flood event must be calculated before:</p>
<ul>
<li>Sum_SM: Sum of snowmelt during the floodevent in mm</li>
<li>Sum_N: Sum of precipitation during the floodevent in mm (For example from the separation of precipitation)</li>
<li>dir_Volume: Direct volume of the flood event (Volume minus baseflow) in Mio. m³/s (This is calculated in the floodevent separation as well as in the output after running the Run_WebFlood)</li>
<li>HQ_dir: Direct peak (instantaneous flood peak minus baseflow) in m³/s (This is calculated in the floodevent separation as well as in the output after running the Run_WebFlood)</li>
<li>PSI_SM: Runoff coefficient of the flood event WITH snowmelt + precipitation</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open the sample flood event data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Sample_Flood_events"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Sample_Flood_events</span><span class="op">)</span></span>
<span><span class="co">#        Begin        End  Peak_date Sum_SM  Sum_N dir_Volume  HQ_dir PSI_SM</span></span>
<span><span class="co"># 1 1950-02-10 1950-02-14 1950-02-11   0.73  14.81      18.45  146.02   0.22</span></span>
<span><span class="co"># 2 1951-01-18 1951-01-26 1951-01-20   1.37  38.45      26.56  108.25   0.12</span></span>
<span><span class="co"># 3 1952-09-12 1952-09-18 1952-09-14   0.09  68.45      22.05  142.18   0.06</span></span>
<span><span class="co"># 4 1953-01-28 1953-02-11 1953-01-30  28.68  52.64     124.25  353.18   0.28</span></span>
<span><span class="co"># 5 1953-02-19 1953-03-04 1953-02-23  17.05   6.27     113.31  209.12   0.89</span></span>
<span><span class="co"># 6 1954-07-08 1954-07-24 1954-07-10   0.09 197.43     545.35 1513.91   0.50</span></span>
<span><span class="co">#    TQDir SM_rel       HQ</span></span>
<span><span class="co"># 1  35.10   0.05  171.622</span></span>
<span><span class="co"># 2  68.15   0.03  130.075</span></span>
<span><span class="co"># 3  43.08   0.00  167.398</span></span>
<span><span class="co"># 4  97.72   0.35  399.498</span></span>
<span><span class="co"># 5 150.51   0.73  241.032</span></span>
<span><span class="co"># 6 100.06   0.00 1676.301</span></span>
<span></span>
<span><span class="co"># Run the event typing</span></span>
<span><span class="va">Floods_typed</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Flood_typology.html">Flood_typology</a></span><span class="op">(</span>Floods <span class="op">=</span> <span class="va">Sample_Flood_events</span>, n_G <span class="op">=</span> <span class="fl">3</span>, Type_3_min_samplesize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Floods_typed</span><span class="op">$</span><span class="va">Type</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># R1 R2 R3 S1 S2 </span></span>
<span><span class="co"># 30 74 10 26  9</span></span>
<span></span>
<span><span class="co"># Plot the event typing</span></span>
<span><span class="va">Floods_Rain</span> <span class="op">&lt;-</span> <span class="va">Floods_typed</span><span class="op">[</span><span class="va">Floods_typed</span><span class="op">$</span><span class="va">Type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"R3"</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Floods_Rain</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dir_Volume</span>, y<span class="op">=</span><span class="va">HQ_dir</span>, fill<span class="op">=</span><span class="va">Type</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">21</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span><span class="op">=</span><span class="st">"#D7191C"</span>, <span class="st">"R2"</span><span class="op">=</span><span class="st">"#FDAE61"</span>, <span class="st">"R3"</span><span class="op">=</span> <span class="st">"#1A9641"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="man/Figure/unnamed-chunk-7-1.svg" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="typewise-and-combined-return-period-estimation-with-the-tmps-model">Typewise and combined return period estimation with the TMPS model<a class="anchor" aria-label="anchor" href="#typewise-and-combined-return-period-estimation-with-the-tmps-model"></a>
</h3>
<p>For the TMPS model, multiple characteristics for each flood event must be present in the input Floods_typed:</p>
<ul>
<li>Peak_date: Date of the peak of the flood event</li>
<li>HQ: Direct peak in m³/s</li>
<li>Type: Flood type of the flood event, preferably as factor</li>
</ul>
<p>Also, a daily discharge timeseries with a “Date” and “Discharge” column is needed</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open the discharge data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Discharge"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Discharge</span><span class="op">)</span></span>
<span><span class="co">#          Date Discharge</span></span>
<span><span class="co"># 1: 1950-01-01  144.2951</span></span>
<span><span class="co"># 2: 1950-01-02  140.8438</span></span>
<span><span class="co"># 3: 1950-01-03  143.0167</span></span>
<span><span class="co"># 4: 1950-01-04  151.4559</span></span>
<span><span class="co"># 5: 1950-01-05  145.1900</span></span>
<span><span class="co"># 6: 1950-01-06  141.6746</span></span>
<span></span>
<span></span>
<span><span class="va">Floods_typed</span> <span class="op">&lt;-</span> <span class="va">Floods_typed</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Peak_date"</span>,<span class="st">"HQ"</span>, <span class="st">"Type"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">TMPS_quantiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/qTMPS.html">qTMPS</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>, </span>
<span>  Flood_events <span class="op">=</span> <span class="va">Floods_typed</span>, Daily_discharge <span class="op">=</span> <span class="va">Discharge</span>, </span>
<span>  return_TMPS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TMPS"</span>, <span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"R3"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TMPS_quantiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">TMPS_quantiles</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TMPS_quantiles</span><span class="op">[</span><span class="va">TMPS_quantiles</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">TMPS_quantiles</span></span>
<span><span class="co">#          2     5    10     20     25     50    100    200    500   1000</span></span>
<span><span class="co"># TMPS 549.5 708.3 897.9 1259.6 1397.7 1911.5 2586.8 3479.1 5122.4 6853.7</span></span>
<span><span class="co"># R1    68.0 236.4 403.4  623.7  709.3 1033.1 1468.9 2056.7 3160.7 4341.5</span></span>
<span><span class="co"># R2   162.7 402.2 616.3  876.4  972.3 1316.2 1743.8 2277.1 3190.5 4083.8</span></span>
<span><span class="co"># R3      NA    NA    NA     NA  165.2  457.7  571.7  616.5  637.2  642.4</span></span>
<span><span class="co"># S1   382.8 472.9 518.2  553.2  562.9  588.9  610.0  627.2  645.1  655.8</span></span>
<span><span class="co"># S2      NA    NA 286.4  525.6  571.6  661.7  705.6  727.2  740.0  744.2</span></span>
<span></span>
<span><span class="co"># Calculate the AMS with TWO SIMPLIFICATIONS FOR EASYNESS : </span></span>
<span><span class="co"># 1) no hydrological years </span></span>
<span><span class="co"># 2) asummption instantaneous peaks == annual max of daily discharge * 1.1</span></span>
<span></span>
<span><span class="va">AMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="op">(</span><span class="va">Discharge</span><span class="op">$</span><span class="va">Discharge</span><span class="op">*</span><span class="fl">1.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">Discharge</span><span class="op">$</span><span class="va">Date</span>,<span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the Results and compare it to the AMS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rmetrics.org" class="external-link">fExtremes</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AMS_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fExtremes/man/GevModelling.html" class="external-link">gevFit</a></span><span class="op">(</span><span class="va">AMS</span>, type<span class="op">=</span><span class="st">"pwm"</span><span class="op">)</span><span class="op">@</span><span class="va">fit</span><span class="op">$</span><span class="va">par.ests</span>  </span>
<span><span class="va">AMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fExtremes/man/GevDistribution.html" class="external-link">qgev</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">25</span>,<span class="fl">50</span>,<span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">500</span>,<span class="fl">1000</span><span class="op">)</span>, mu<span class="op">=</span><span class="va">AMS_params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, xi<span class="op">=</span><span class="va">AMS_params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, beta<span class="op">=</span><span class="va">AMS_params</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TMPS_quantiles</span>, AMS<span class="op">=</span><span class="va">AMS</span><span class="op">)</span></span>
<span><span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Results</span>, <span class="st">"Method"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Results</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Results_melt</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">Results</span>, id.vars <span class="op">=</span> <span class="st">"Method"</span>, variable.name <span class="op">=</span> <span class="st">"Annuality"</span><span class="op">)</span></span>
<span><span class="va">Results_melt</span><span class="op">$</span><span class="va">Annuality</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Results_melt</span><span class="op">$</span><span class="va">Annuality</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AMS"</span><span class="op">=</span><span class="st">"black"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="st">"#D7191C"</span>, R2 <span class="op">=</span> <span class="st">"#FDAE61"</span>, R3 <span class="op">=</span> <span class="st">"#1A9641"</span>, S1 <span class="op">=</span> <span class="st">"#6BAED6"</span>, S2 <span class="op">=</span> <span class="st">"#2171B5"</span><span class="op">)</span>,  <span class="st">"TMPS"</span><span class="op">=</span><span class="st">"darkorchid1"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Results_melt</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Annuality</span>, y<span class="op">=</span><span class="va">value</span>, colour <span class="op">=</span> <span class="va">Method</span> <span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">cols</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"T[a]"</span>,y<span class="op">=</span><span class="st">"Peak discharge [m³/s]"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_logticks.html" class="external-link">annotation_logticks</a></span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span>
<span><span class="co"># Warning: Removed 6 row(s) containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="man/Figure/unnamed-chunk-8-1.svg" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Calculate </span></span>
<span><span class="va">TMPS_probs_from_AMS_quants</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pTMPS.html">pTMPS</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">AMS</span><span class="op">)</span>, </span>
<span>  Flood_events <span class="op">=</span> <span class="va">Floods_typed</span>, Daily_discharge <span class="op">=</span> <span class="va">Discharge</span>, </span>
<span>  return_TMPS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TMPS"</span>, <span class="st">"R1"</span>, <span class="st">"R2"</span>, <span class="st">"R3"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TMPS_probs_from_AMS_quants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">TMPS_probs_from_AMS_quants</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">TMPS_probs_from_AMS_quants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">TMPS_probs_from_AMS_quants</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">TMPS_probs_from_AMS_quants</span></span>
<span><span class="co">#       410   589   737  906  966 1174 1418  1706  2167  2590</span></span>
<span><span class="co"># TMPS  1.8   2.4   6.3 10.2 11.6 17.2 25.8  38.7  66.5 100.3</span></span>
<span><span class="co"># R1   10.2  18.2  26.8 39.0 44.0 64.0 93.1 135.7 223.2 325.8</span></span>
<span><span class="co"># R2    5.1   9.2  14.0 21.5 24.6 38.2 59.8  94.6 175.4 282.4</span></span>
<span><span class="co"># R3   42.3 122.0    NA   NA   NA   NA   NA    NA    NA    NA</span></span>
<span><span class="co"># S1    2.5  50.1    NA   NA   NA   NA   NA    NA    NA    NA</span></span>
<span><span class="co"># S2   13.4  27.6 369.3   NA   NA   NA   NA    NA    NA    NA</span></span></code></pre></div>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing FloodR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Philipp Buehler <br><small class="roles"> Author, maintainer </small>  </li>
<li>Svenja Fischer <br><small class="roles"> Author </small>  </li>
<li>Laura Haendel <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Philipp Buehler, Svenja Fischer, Laura Haendel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
