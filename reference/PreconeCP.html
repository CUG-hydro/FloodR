<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Determine the begin of event precipitation — PreconeCP • FloodR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Determine the begin of event precipitation — PreconeCP"><meta property="og:description" content="The cumulative precipitation is used to estimate the begin of the event
precipitation using a change point estimation. For this, the time series is
divided into two subsamples and the slope is estimated for each subsample
using linear regression and least squares estimation. This is done for all
possible combinations of two consecutive subsamples, such that the change
point can be estimated as the point where the maximum difference between the
slopes of the two subsamples occurs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FloodR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Determine the begin of event precipitation</h1>
    
    <div class="hidden name"><code>PreconeCP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The cumulative precipitation is used to estimate the begin of the event
precipitation using a change point estimation. For this, the time series is
divided into two subsamples and the slope is estimated for each subsample
using linear regression and least squares estimation. This is done for all
possible combinations of two consecutive subsamples, such that the change
point can be estimated as the point where the maximum difference between the
slopes of the two subsamples occurs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PreconeCP</span><span class="op">(</span><span class="va">Prec_table</span>, <span class="va">indT</span>, min_step <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Prec_table</dt>
<dd><p>A dataframe with the first column equal to the date and the
second column consisting of the daily precipitation sums [mm].</p></dd>


<dt>indT</dt>
<dd><p>An integer vector with three entries: first the index of date in
X of the begin of the flood event, second the index of date in X of the end
of the flood event and third the index of the date in X of the peak of the
flood event.</p></dd>


<dt>min_step</dt>
<dd><p>The minimum required number of data points used for the
linear regression to determine the slope. At default it is set to 3 and it
is recommended to use no shorter length.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A date that indicates the estimated begin of the event
precipitation.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>We want to estimated the event precipitation by comparing the rising limb of
the discharge with the rising limb of precipitation. Here, we assumed that
the begin of the increase of the hydrograph indicates the begin of the event
precipitation, whereas the end of the flood event automatically defines the
end of the event precipitation. Due to catchment reaction times, a possible
delay of the begin of event precipitation and the begin of the flood event
has to be considered. For this purpose a buffer time period b between the
begin of the precipitation and the flood event was used. Here, b was defined
as \(b=\max (rt,7)\), where rt is the duration of the rising limb of the
flood event. Then the begin of event precipitation \(hat{k}\) was defined
by the change-point of the slope of the cumulative precipitation sum in this
period: $$\hat{k}=\arg {{\max }_{{{t}_{start}}-b\le k\le
{{t}_{peak}}+b}}\{{{\beta }_{k:{{t}_{peak}}+b}}-{{\beta
}_{{{t}_{start}}-b:k}}\},$$ where \(\beta_{i:j}\) is the slope of the
linear regression for the sum of all precipitation values
\(P_i,\ldots,P_j\) derived by least-squares method. This means, we divided
the cumulative sums of the precipitation beginning b days before the begin
of the flood event and ending b days after the day of the flood peak into
two parts and used the time step where the difference of the slope of these
two parts was maximal to define the begin of the precipitation. Each part
had to consist of at least three days.  The end of the event precipitation
was defined equally to one day before the end of flood event.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Philipp Bühler, Svenja Fischer</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dailyprec</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01.01.2000"</span>, format<span class="op">=</span><span class="st">"%d.%m.%Y"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"30.04.2000"</span>, format<span class="op">=</span><span class="st">"%d.%m.%Y"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"days"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>discharge<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">121</span>,<span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">indT</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">30</span>,<span class="fl">14</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">dailyprec</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">30</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">PreconeCP</span><span class="op">(</span>X<span class="op">=</span><span class="va">dailyprec</span>,<span class="va">indT</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philipp Buehler, Svenja Fischer, Laura Haendel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

